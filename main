"""hello my name is Nishant Mall(INTERN at Infosys Springboard)
here i'm trying to do a prediction of the habitability of exoplanets"""

import pandas as pd
df = pd.read_csv("data1.csv", skiprows=56)
file_name = "data1.csv"
#print column number
print("Total number of columns:", len(df.columns))

#print the column name
column_names = df.columns.tolist()
print(column_names)

#calculate the number of missing values (NaN) per column
missing_data_count = df.isnull().sum()

#filter out columns with zero missing values for a focused output
missing_data_count = missing_data_count[missing_data_count > 0]

#convert the result a pandas Series to a DataFrame and rename the column
missing_data_df = missing_data_count.to_frame(name='Missing Count')

#print the resulting data which shows the column name and the count of missing data
print(missing_data_df)

df = pd.read_csv(file_name, skiprows=56)

# --- Calculate Total Cells ---
num_rows = df.shape[0]
num_cols = df.shape[1]
total_cells = num_rows * num_cols

# --- Calculate Total Empty Cells ---
# Sums up all True values (NaN/Missing) across all columns and rows
empty_cells = df.isnull().sum().sum()

# --- Calculate Percentage of Empty Cells ---
percentage_empty = (empty_cells / total_cells) * 100

# --- Print Results ---
print(f"Total rows: {num_rows}")
print(f"Total columns: {num_cols}")
print(f"Total cells in the table: {total_cells}")
print(f"Total empty (missing) cells: {empty_cells}")
print(f"Percentage of data that is empty: {percentage_empty}")

#select data and drop NaN values to ensure accurate quantile calculation
data = df['pl_orbper'].dropna()

#calculate Quartiles and IQR
Q1 = data.quantile(0.25)
Q3 = data.quantile(0.75)
IQR = Q3 - Q1

#define the fences
lower_fence = Q1 - 1.5 * IQR
upper_fence = Q3 + 1.5 * IQR

#count the number of values outside the fences
outliers_count = data[(data < lower_fence) | (data > upper_fence)].count()

#inconsistent entries count

#based on the structural analysis of key categorical columns like casing/whitespace
#zero structural inconsistencies were found
inconsistent_count = 0

# print result
print(f"Inconsistent Entries (Casing/Whitespace): {inconsistent_count}")
print(f"Outliers (in 'pl_orbper' by 1.5*IQR rule): {outliers_count}")


import pandas as pd
import matplotlib.pyplot as plt
from scipy.stats import zscore
import numpy as np

# --- Load Data ---
file_name = "data1.csv"
# load the file, skipping the 56 metadata rows
df = pd.read_csv(file_name, skiprows=56)

# --- data Preparation and Standardization ---

# identify all numerical columns (44 out of 50 total columns)
numerical_cols = df.select_dtypes(include=np.number).columns.tolist()

# standardize data to Z-scores (Mean=0, StdDev=1)
# this is necessary to plot different columns on a single, comparable scale.
standardized_data = df[numerical_cols].apply(zscore, nan_policy='omit')

# ---  Box Plot Generation ---

# use a large figure size to accommodate 44 columns horizontally
plt.figure(figsize=(25, 10))

#plot the standardized data
plt.boxplot(standardized_data.values, 
            labels=numerical_cols,
            patch_artist=True,
            # Customize outlier markers for better visibility
            flierprops=dict(marker='o', markersize=2, alpha=0.5)) 

plt.title('Box Plots of ALL Numerical Columns (Standardized to Z-Scores)', fontsize=20)
plt.ylabel('Z-Score', fontsize=14)

#rotate column labels for readability
plt.xticks(rotation=90, fontsize=10)
plt.yticks(fontsize=12)
plt.grid(True, axis='y', linestyle='--', alpha=0.6)

plt.show()


cols_to_plot = ['sy_snum', 'disc_year', 'sy_pnum', 'default_flag']

#create a figure and a 2x2 grid of subplots
fig, axes = plt.subplots(2, 2, figsize=(14, 10))
axes = axes.flatten() # Flatten the array for easy indexing

# --- Iterate and Plot ---
for i, col in enumerate(cols_to_plot):
    #box plot for the current column
    axes[i].boxplot(df[col].dropna(), 
                    vert=False,         # Horizontal plot
                    patch_artist=True)
    
    axes[i].set_title(f'Box Plot for {col}', fontsize=14)
    
    #custom labels for better context
    if col == 'disc_year':
        axes[i].set_xlabel('Discovery Year')
    elif col == 'sy_snum':
        axes[i].set_xlabel('Number of Stars in System')
    elif col == 'sy_pnum':
        axes[i].set_xlabel('Number of Planets in System')
    elif col == 'default_flag':
        axes[i].set_xlabel('Default Flag (0 or 1)')
    
    axes[i].grid(True, linestyle='--', alpha=0.6)

#adjust layout to prevent plot titles/labels from overlapping
plt.tight_layout()
plt.show()
